@import turqey.entity._
@import turqey.servlet._
@import turqey.controller._

@(articles: Seq[Article], stocks: Seq[scala.Long], tagsByArticleId: scala.collection.immutable.Map[scala.Long, Seq[(scala.Long, Tag)]])
<html>
  @css()
  <body>
    <script type="text/javascript" src="@assets/vender/js/materialize.js"></script>
    <script type="text/javascript" src="@assets/vender/js/knockout.js"></script>
    @topnav()
    <main>
    <div class="container">
      <p>CSV知識を共有しよう。</p>
      <p>
        <a href="@root/article/edit" class="waves-effect waves-light btn"><i class="material-icons right">edit</i>新規作成</a>
      </p>
      <div class="row">
        <div class="col s12">
          <ul class="tabs">
            @*
            <li class="tab col s2"><a class="waves-effect" href="#following">フォロー中</a></li>
            *@
            <li class="tab col"><a class="active waves-effect" href="#whole">全ての投稿</a></li>
            @*
            <li class="tab col s2 disabled"><a href="#"></a></li>
            <li class="tab col s2 disabled"><a href="#"></a></li>
            *@
            <li class="tab col"><a class="waves-effect" href="#stock">ストック</a></li>
            <li class="tab col"><a class="waves-effect" href="#own">自分の投稿</a></li>
          </ul>
        </div>
        @*
        <div id="following" class="col s12">W.I.P.</div>
        *@
        <div id="whole" class="col s12">
          @*
          <ul class="pagination" style="text-align: center;">
            <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
            <li class="active"><a href="#!">1</a></li>
            <li class="waves-effect"><a href="#!">2</a></li>
            <li class="waves-effect"><a href="#!">3</a></li>
            <li class="waves-effect"><a href="#!">4</a></li>
            <li class="waves-effect"><a href="#!">5</a></li>
            <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
          </ul>
          *@
          <div class="collection">
          @articles.map{ a =>
            <a href="@root/article/@a.id" class="collection-item waves-effect waves-light">
              <span class="title" href="@root/article/@a.id">@a.title</span>
              <p>
                @a.owner.get.name @a.created.toString("yyyy/MM/dd")
              </p>
              <p>
              @tagsByArticleId.getOrElse(a.id, Seq()).map { case (id, tag) =>
                <div class="chip">
                  @tag.name
                </div>
              }
              </p>
            </a>
          }
          </div>
        </div>
        <div id="stock" class="col s12">
          <div class="collection">
          @articles.filter( a => stocks.contains(a.id) ).map{ a =>
            <a href="@root/article/@a.id" class="collection-item waves-effect waves-light">
              <span class="title" href="@root/article/@a.id">@a.title</span>
              <p>
                @a.owner.get.name @a.created.toString("yyyy/MM/dd")
              </p>
              <p>
              @tagsByArticleId.getOrElse(a.id, Seq()).map { case (id, tag) =>
                <div class="chip">
                  @tag.name
                </div>
              }
              </p>
            </a>
          }
          </div>
        </div>
        <div id="own" class="col s12">
          <div class="collection">
          @articles.filter(a => a.ownerId == SessionHolder.user.get.id).map{ a =>
            <a href="@root/article/@a.id" class="collection-item waves-effect waves-light">
              <span class="title" href="@root/article/@a.id">@a.title</span>
              <p>
                @a.owner.get.name @a.created.toString("yyyy/MM/dd")
              </p>
              <p>
              @tagsByArticleId.getOrElse(a.id, Seq()).map { case (id, tag) =>
                <div class="chip">
                  @tag.name
                </div>
              }
              </p>
            </a>
          }
          </div>
        </div>
      </div>
    </div>
    </main>
  </body>
</html>
