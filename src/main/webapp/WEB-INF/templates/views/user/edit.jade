- import turqey.servlet.ServletContextHolder._
- import turqey.entity._
- import turqey.servlet._
- import turqey.utils.Implicits._
- import turqey.utils.Json

-@val u: Option[User]

div.container(style="margin-top: 10px;")
  div.row
    div.col.s4
      div()
        a.modal-trigger(href="#modal1")
          img(src="#{root}/user/#{u.map(_.id)}/image" style="width: 200px;height: 200px;")
    div.col.s8
      form.col.s12#form(action="#{root}/user/#{u.map(_.id)}" method="post")
        div.row
          - if(!u.isDefined)
            div.input-field.col.s12
              input(type="text" name="loginId" value="#{u.map(_.loginId)}" length="120")
              label ID
          - if(u.isDefined)
            div.input-field.col.s12
              input(type="text" value="#{u.map(_.loginId)}" readonly="true")
              label ID
        div.row
          div.input-field.col.s12
            input(type="text" name="name" value="#{u.map(_.name)}" length="120")
            label Name
        div.row
          div.input-field.col.s12
            input(type="text" name="email" value="#{u.map(_.email)}" length="120")
            label Mail
        div.row
          div.input-field.col.s12
            input(type="text" name="password" length="120")
            label Pass
        div.row
          div.input-field.col.s12
            input.filled-in#filled-in-box{
              :type=>"checkbox",
              :name=>"root",
              :checked=>{u.map(_.root).getOrElse(false)},
              :disabled=>{!(u.map(u => SessionHolder.root && !u.self ).getOrElse(false))} }
            label(for="filled-in-box") 管理者  
        textarea.base64(style="display: none;")
    button.waves-effect.waves-light.btn(type="submit")
      i.material-icons.right check
      |保存
  div#modal1.modal.modal-fixed-footer
    div.modal-content
      h4 Modal Header
      div
        canvas.photo#preview
    div.modal-footer
      a.modal-action.modal-close.waves-effect.waves-green.btn-flat(href="#!") キャンセル
      a.modal-action.modal-close.waves-effect.waves-green.btn-flat(href="#!") 決定

:!javascript
  $(document).ready(function(){
    $('.modal-trigger').leanModal();
    
    $('modal1').bind('drop', function(e){
      e.preventDefault();
      var files = e.originalEvent.dataTransfer.files;
      loadFile(files[0], function() {
        var canvas = document.getElementById('photo');
        var context = canvas.getContext('2d');
        canvas.width = imageObj.width;
        canvas.height = imageObj.height;
        context.drawImage(imageObj, 0, 0);
      });
    }).bind('dragenter', function(){
      return false;
    }).bind('dragover', function(){
      return false;
    });
  });
